[package]
name = "rsasl"
version = "2.0.0-alpha1"
authors = ["Nadja Reitzenstein <me@dequbed.space>"]
edition = "2021"
rust-version = "1.56.0"

description = """The Rust SASL framework, aimed at both middleware-style protocol implementation and application code.
Designed to make SASL authentication simple and safe while handing as much control to the user as possible.
"""
documentation = "https://docs.rs/rsasl"
readme = "README.md"

homepage = "https://github.com/dequbed/rsasl"
repository = "https://github.com/dequbed/rsasl"
license = "LGPL-2.1-or-later"

keywords = ["sasl", "authentication", "sso", "framework", "middleware"]
categories = ["authentication", "api-bindings", "network-programming"]

# Manually list files to include; this skips examples, integration tests and testing binaries that arent useful when
# rsasl is only used as a dependency.
include = ["Cargo.toml", "/src/", "README.md", "CHANGELOG.md", "LICENSE", "/docs/"]
# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[features]
default = [
    "config_builder",
    "registry_static",
    "scram-sha-1", "scram-sha-2",
    "digest-md5", "cram-md5",
    "anonymous", "external",
    "plain", "login",
    "securid",
    "openid20", "saml20"
]

## Enable use of libstd
## If this flag is not set, rsasl is marked ![no_std]. However, currently this flag will *always* be enabled as core
## parts of rsasl depend on the stdlib.
std = []

gsasl = ["libc"]

#! ## Compile-time mechanism selection
## Enable `SCRAM-SHA-1` and `SCRAM-SHA-1-PLUS`
scram-sha-1 = ["std", "saslprep", "hmac", "digest", "sha-1", "base64", "rand", "pbkdf2"]
## Enable `SCRAM-*` and `SCRAM-*-PLUS` mechanisms using `SHA-2`, i.e. `SHA-256` and `SHA-512`
scram-sha-2 = ["std", "saslprep", "hmac", "digest", "sha2", "base64", "rand", "pbkdf2"]
## Enable `DIGEST-MD5`
digest-md5 = ["std", "gsasl", "saslprep", "hmac", "digest", "md-5", "base64"]
## Enable `CRAM-MD5`
cram-md5 = ["std", "gsasl", "saslprep", "hmac", "digest", "md-5"]
## Enable `ANONYMOUS`
anonymous = ["std"]
## Enable `EXTERNAL`
external = ["std"]
## Enable `PLAIN`
plain = ["std", "saslprep"]
## Enable `LOGIN`
login = ["std"]
## Enable `OPENID20`
openid20 = ["std", "gsasl"]
## Enable `SAML20`
saml20 = ["std", "gsasl"]
## Enable `SECURID`
securid = ["std", "gsasl"]
## Enable `XOAUTH2`
xoauth2 = ["std"]

#! ## Provider flags
#! These flags are relevant for crates that want to use rsasl as authentication provider, i.e. crates implementing
#! network protocols

## Enable provider mode
##
## This feature enables all the required code for providers, e.g. code surrounding `Session`
provider = ["std"]
## Enable transparent Base64 wrapping for provider mode
##
## This enables the `step64` method to wrap a call to `step` in base64-encoding. Adds a dependency on the `base64` crate
provider_base64 = ["std", "provider", "base64"]

#! ## Supplier flags
#! These flags are relevant for crates that want to use rsasl as supplier, i.e. applications and libraries making use
#! of protocol implementations with rsasl support
## Enable the ConfigBuilder
config_builder = ["std"]

## Enables the static registry using `linkme`
registry_static = ["std", "linkme"]

## Enable utilities for testing authentication and SASL handling
testutils = ["std", "config_builder"]

saslprep = ["std", "stringprep"]

unstable_custom_mechanism = ["std"]

[dependencies]
thiserror = "1.0"

rustls = { version = "0.20.6", optional = true }

libc = { version = "0.2", optional = true }

base64 = { version = "0.13", optional = true }

rand = { version = "0.8", optional = true }

hmac = { version = "0.12", optional = true, features = ["reset"] }
digest = { version = "0.10", optional = true }
sha-1 = { version = "0.10", optional = true }
sha2 = { version = "0.10", optional = true }
md-5 = { version = "0.10", optional = true }

pbkdf2 = { version = "0.10", optional = true, default_features = false }

stringprep = { version = "0.1", optional = true }

linkme = { version = "0.2", optional = true }

[dev-dependencies]
static_assertions = "1.1.0"

[[example]]
name = "scram_server"
required-features = ["provider", "scram-sha-1"]
[[example]]
name = "scram_client"
required-features = ["provider", "scram-sha-1"]

[[example]]
name = "scram256_server"
required-features = ["provider", "scram-sha-2"]
[[example]]
name = "scram256_client"
required-features = ["provider", "scram-sha-2"]

[[example]]
name = "plain_client"
required-features = ["provider", "plain"]
[[example]]
name = "plain_server_callback"
required-features = ["provider", "plain"]

[[example]]
name = "protocol"
required-features = ["provider", "login", "plain", "scram-sha-1", "scram-sha-2"]

[workspace]
members = ["examples/server", "bin/interop-client", "bin/interop-server"]
